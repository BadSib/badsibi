<html>
<head>
<title>NASA Task Load Index</title>

<script language="JavaScript" type="49d6f498c980deac7abfe311-text/javascript"> 
<!--
 
// Create a set of parallel arrays for each of the scales
var scale      = new Array();
var left       = new Array();
var right      = new Array();
var def        = new Array();
var NUM_SCALES = 6;
 
scale[0]  = "Geistige Anforderung"; 
left[0]   = "Gering";
right[0]  = "Hoch";
def[0]    = "Wie viel geistige Anforderung war bei der Informationsaufnahme und bei der Informationsverarbeitung erforderlich (z.B. Denken, Entscheiden, Rechnen, Erinnern, Hinsehen, Suchen ...)? War die Aufgabe leicht oder anspruchsvoll, einfach oder komplex, erfordert sie hohe Genauigkeit oder ist sie fehlertolerant?";
 
scale[1]  = "Körperliche Anforderung"; 
left[1]   = "Gering";
right[1]  = "Hoch";
def[1]    = "Wie viel körperliche Aktivität war erforderlich (z.B. ziehen, drücken, drehen, steuern, aktivieren ...)? War die Aufgabe leicht oder schwer, einfach oder anstrengend, erholsam oder mühselig?";
 
scale[2]  = "Zeitliche Anforderung"; 
left[2]   = "Gering";
right[2]  = "Hoch";
def[2]    = "Wie viel Zeitdruck empfanden Sie hinsichtlich der Häufigkeit oder dem Takt mit dem die Aufgaben oder Aufgabenelemente auftraten? War die Aufgabe langsam und geruhsam oder schnell und hektisch?";
 
scale[3]  = "Leistung"; 
left[3]   = "Gut";
right[3]  = "Schlecht";
def[3]    = "Wie erfolgreich haben Sie Ihrer Meinung nach die vom Versuchsleiter (oder Ihnen selbst) gesetzten Ziele erreicht? Wie zufrieden waren Sie mit Ihrer Leistung bei der Verfolgung dieser Ziele?";
 
scale[4]  = "Anstrengung"; 
left[4]   = "Gering";
right[4]  = "Hoch";
def[4]    = "Wie hart mussten Sie arbeiten, um Ihren Grad an Aufgabenerfüllung zu erreichen?";
 
scale[5]  = "Frustration"; 
left[5]   = "Gering";
right[5]  = "Hoch";
def[5]    = "Wie unsicher, entmutigt, irritiert, gestresst und verärgert (versus sicher, bestätigt, zufrieden, entspannt und zufrieden mit sich selbst) fühlten Sie sich während der Aufgabe?";
 
// Pairs of factors in order in the original instructions, numbers
// refer to the index in the scale, left, right, def arrays.
var pair  = new Array();
pair[0]   = "4 3";
pair[1]   = "2 5";
pair[2]   = "2 4";
pair[3]   = "1 5";
pair[4]   = "3 5";
pair[5]   = "1 2";
pair[6]   = "1 3";
pair[7]   = "2 0";
pair[8]   = "5 4";
pair[9]   = "3 0";
pair[10]  = "3 2";
pair[11]  = "0 4";
pair[12]  = "0 1";
pair[13]  = "4 1";
pair[14]  = "5 0";
 
// Variable where the results end up
var results_rating = new Array();
var results_tally  = new Array();
var results_weight = new Array();
var results_overall;
 
var pair_num = 0;
for (var i = 0; i < NUM_SCALES; i++)
	results_tally[i] = 0;
 
// Used to randomize the pairings presented to the user
function randOrd()
{
	return (Math.round(Math.random())-0.5); 
}
 
// Make sure things are good and mixed
for (i = 0; i < 100; i++)
{
	pair.sort(randOrd);
}
 
// They click on a scale entry
function scaleClick(index, val)
{
	results_rating[index] = val;
 
	// Turn background color to white for all cells
	for (i = 5; i <= 100; i += 5)
	{
		var top = "t_" + index + "_" + i;
		var bottom = "b_" + index + "_" + i;
		document.getElementById(top).bgColor='#FFFFFF';
		document.getElementById(bottom).bgColor='#FFFFFF';
	}
 
	var top = "t_" + index + "_" + val;
	var bottom = "b_" + index + "_" + val;
	document.getElementById(top).bgColor='#AAAAAA';
	document.getElementById(bottom).bgColor='#AAAAAA';
}
 
// Return the HTML that produces the table for a given scale
function getScaleHTML(index)
{
	var result = "";
 
	// Outer table with a column for scale, column for definition
	result += '<table><tr><td>';
 
	// Table that generates the scale
	result += '<table class="scale">';
 
	// Row 1, just the name of the scale
	result += '<tr><td colspan="20" class="heading">' + scale[index] + '</td></tr>';
 
	// Row 2, the top half of the scale increments, 20 total columns
	result += '<tr>';
	var num = 1;
	for (var i = 5; i <= 100; i += 5)
	{
		result += '<td id="t_' + index + '_' + i + '"   class="top' + num + '" onMouseUp="scaleClick(' + index + ', ' + i + ');"></td>';
		num++;
		if (num > 2)
			num = 1;
	}
	result += '</tr>';
 
	// Row 3, bottom half of the scale increments
	result += '<tr>';
	for (var i = 5; i <= 100; i += 5)
	{
		result += '<td id="b_' + index + '_' + i + '"   class="bottom" onMouseUp="scaleClick(' + index + ', ' + i + ');"></td>';
	}
	result += '</tr>';
 
	// Row 4, left and right of range labels
	result += '<tr>';
	result += '<td colspan="10" class="left">' + left[index] + '</td><td colspan="10" class="right">' + right[index] + '</td>';
	result += '</tr></table></td>';
 
 
	// Now for the definition of the scale
	result += '<td class="def">';
	result += def[index];
	result += '</td></tr></table>';
 
	return result;
}
 
function onLoad()
{
	// Get all the scales ready
	for (var i = 0; i < NUM_SCALES; i++)
	{
		document.getElementById("scale" + i).innerHTML = getScaleHTML(i);
	}
}
 
// Users want to proceed after doing the scales
function buttonPart1()
{
	// Check to be sure they click on every scale
	for (var i = 0; i < NUM_SCALES; i++)
	{
		if (!results_rating[i])
		{
			alert('Es muss ein Wert fuer jede Skale ausgewaehlt werden!');
			return false;
		}
	}

	var uid = document.getElementById('user_id').value;
	calcResults();
	var csv_res = getResultsCSV();
	copyStringToClipboard(results_overall);
	download("tlx_" +uid+ ".txt", uid+";"+csv_res);

	document.getElementById('div_part4').innerHTML = getResultsHTML();	

	// Bye bye part 1, hello part 4
	document.getElementById('div_part1').style.display = 'none'; 
	//document.getElementById('div_part2').style.display = ''; 
 	document.getElementById('div_part4').style.display = ''; 

	return true;
}
 
// User done reading the part 2 instructions
function buttonPart2()
{
	// Bye bye part 2, hello part 3
	document.getElementById('div_part2').style.display = 'none'; 
	document.getElementById('div_part3').style.display = ''; 
 
	// Set the labels for the buttons
	setPairLabels();
	return true;
}
 
// Set the button labels for the pairwise comparison stage
function setPairLabels()
{
	var indexes = new Array();
	indexes = pair[pair_num].split(" ");
 
	var pair1 = scale[indexes[0]];
	var pair2 = scale[indexes[1]];
 
	document.getElementById('pair1').value = pair1;
	document.getElementById('pair2').value = pair2;
 
	document.getElementById('pair1_def').innerHTML = def[indexes[0]];
	document.getElementById('pair2_def').innerHTML = def[indexes[1]];
}
 
// They clicked the top pair button
function buttonPair1()
{
	var indexes = new Array();
	indexes = pair[pair_num].split(" ");
	results_tally[indexes[0]]++;	
 
	nextPair();
	return true;
}
 
// They clicked the bottom pair button
function buttonPair2()
{
	var indexes = new Array();
	indexes = pair[pair_num].split(" ");
	results_tally[indexes[1]]++;	
	nextPair();
	return true;
}
 
// Compute the weights and the final score
function calcResults()
{
	results_overall = 0.0;
 
	for (var i = 0; i < NUM_SCALES; i++)
	{
		//results_weight[i] = results_tally[i] / 15.0;
		//results_overall += results_weight[i] * results_rating[i];
		results_overall += results_rating[i];
	}
	results_overall /= NUM_SCALES;
}
 
// Output the table of results
function getResultsHTML()
{
	var result = "";

	//result += "<table><tr><td></td><td>Rating</td><td>Tally</td><td>Weight</td></tr>";
	result += "<table><tr><td></td><td>Rating</td></tr>";
	for (var i = 0; i < NUM_SCALES; i++)
	{
		result += "<tr>";

		result += "<td>";
		result += scale[i];
		result += "</td>";

		result += "<td>";
		result += results_rating[i];
		result += "</td>";

		//result += "<td>";
		//result += results_tally[i];
		//result += "</td>";

		//result += "<td>";
		//result += results_weight[i];
		//result += "</td>";

		result += "</tr>";
	}

	result += "</table>";
	result += "<br/>";
	result += "Overall = ";
	result += results_overall;
	result += "<br/>";

	return result;
}

function download(filename, text) {
	var element = document.createElement('a');
	element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
	element.setAttribute('download', filename);
  
	element.style.display = 'none';
	document.body.appendChild(element);
  
	element.click();
  
	document.body.removeChild(element);
}

function copyStringToClipboard (str) {
	// Temporäres Element erzeugen
	var el = document.createElement('textarea');
	// Den zu kopierenden String dem Element zuweisen
	el.value = str;
	// Element nicht editierbar setzen und aus dem Fenster schieben
	el.setAttribute('readonly', '');
	el.style = {position: 'absolute', left: '-9999px'};
	document.body.appendChild(el);
	// Text innerhalb des Elements auswählen
	el.select();
	// Ausgewählten Text in die Zwischenablage kopieren
	document.execCommand('copy');
	// Temporäres Element löschen
	document.body.removeChild(el);
 }

// Output the table of results
function getResultsCSV()
{
	var result = "";
	for (var i = 0; i < NUM_SCALES; i++)
	{
		result += scale[i];
		result += ";";
		result += results_rating[i];
		result += ";";
	}

	
	result += results_overall;
	
	return result;
}
// Move to the next pair
function nextPair()
{
	pair_num++;
	if (pair_num >= 15)
	{
		document.getElementById('div_part3').style.display = 'none'; 
		document.getElementById('div_part4').style.display = '';
		calcResults();
		document.getElementById('div_part4').innerHTML = getResultsHTML();		
	}
	else
	{
		setPairLabels();
	}
}
 
// -->
</script>
<style> 
td.bottom
{
	width: 0.6cm;
      height: 0.4cm;
	border-bottom: 1px solid black;
	border-left: 1px solid black;
	border-right: 1px solid black;
	margin: 0px; 
	padding: 0px 0px 0px 0px;
 
}
 
table.scale
{
	margin: 0px;
	padding: 0px 0px 0px 0px;
      border-collapse: collapse
}
 
td.top1
{
	width: 0.6cm;
      height: 0.4cm;
	border-top: 1px solid black;
	border-left: 1px solid black;
	margin: 0px; 
	padding: 0px 0px 0px 0px;
}
td.top2
{
	width: 0.6cm;
      height: 0.4cm;
	border-top: 1px solid black;
	border-right: 1px solid black;
	margin: 0px; 
	padding: 0px 0px 0px 0px;
}
td.heading
{
	font: Bold 14px Arial, Helvetica, sans-serif;
	text-align: center;
}
td.left
{
	font: 14px Arial, Helvetica, sans-serif;
}
td.right
{
	font: 14px Arial, Helvetica, sans-serif;
	text-align: right;
}
 
td.def
{
	width: 12cm;	
	padding: 0px 0px 0px 20px;
	font: 12px Arial, Helvetica, sans-serif;
}
 
input.pair
{
	width: 5cm;
	height: 1cm;
	font: Bold 14px Arial, Helvetica, sans-serif;
}
</style>
</head>
<script src="https://ajax.cloudflare.com/cdn-cgi/scripts/95c75768/cloudflare-static/rocket-loader.min.js" data-cf-settings="49d6f498c980deac7abfe311-|49"></script><body onLoad="onLoad();">
<div id="div_part1">
	<h1>NASA TLX Fragebogen</h1><br />

	Bitte User ID eintragen: <input type="number" id="user_id" name ="" value="0" /> 
	<br />
	<br />
Klicken Sie in jeder Skale auf den Punkt, der Ihre Erfahrung im Hinblick auf die Aufgabe am besten verdeutlicht. <br />
<br />
<div id="scale0"></div>
<div id="scale1"></div>
<div id="scale2"></div>
<div id="scale3"></div>
<div id="scale4"></div>
<div id="scale5"></div>
<br />
<input class="next" id="next" type="button" value="Continue >>" onClick="if (!window.__cfRLUnblockHandlers) return false; buttonPart1();" data-cf-modified-49d6f498c980deac7abfe311-="">
</div>
<div id="div_part2" style="display:none">
Fragebogen - Teil 2 <br />
<br />
Klicken Sie in jedem der 15 nachfolgenden Fenster auf die Beanspruchungsdimension,
die für das Gesamtempfinden hinsichtlich der Aufgabe die jeweils bedeutsamere war.
<br />
<br />
<input class="next" id="next" type="button" value="Weiter >>" onClick="if (!window.__cfRLUnblockHandlers) return false; buttonPart2();" data-cf-modified-49d6f498c980deac7abfe311-="">
</div>
<div id="div_part3" style="display:none">
Fragebogen - Teil 2 <br />
<br />
<br />
Klicken Sie auf die Dimension, die den jeweils wichtigeren Beitrag zur Arbeitsbelastung hinsichtlich der Aufgabe darstellt.
<br />
<br />
<table>
<tr>
<td><input class="pair" id="pair1" type="button" value="" onClick="if (!window.__cfRLUnblockHandlers) return false; buttonPair1();" data-cf-modified-49d6f498c980deac7abfe311-=""> </td>
<td class="def"><div id="pair1_def"></div></td>
</tr>
<tr>
<td align="center"> or </td>
<td></td>
</tr>
<tr>
<td><input class="pair" id="pair2" type="button" value="" onClick="if (!window.__cfRLUnblockHandlers) return false; buttonPair2();" data-cf-modified-49d6f498c980deac7abfe311-=""></td>
<td class="def"><div id="pair2_def"></div></td>
</tr>
</table>
</div>
<div id="div_part4" style="display:none">
</div>
<script src="https://ajax.cloudflare.com/cdn-cgi/scripts/95c75768/cloudflare-static/rocket-loader.min.js" data-cf-settings="49d6f498c980deac7abfe311-|49" defer=""></script></body>
</html>